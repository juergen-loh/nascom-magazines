<?php columnStartJustify(2, 2); ?>

<p>
behandelt:
</p>
<p>
Carry = 1 wenn Fehler sonst 0
</p>
<p>
bei Fehler A=Fehlernummer (fuer Pheas stehen
die Fehlernummern 10-1F zur Verfuegung).
</p>
<p>
Der Bootstap-Loader liest aus den ersten Sektoren der Diskette das DOS
in den dafuer vorgesehenen Speicherbereich. Moeglicherweise wird auch
<span class="uppercase">Nassys</span> mitgeladen (sh. beiliegenden Sourcecode).
</p>
<h4>
Das Formatierungs-Programm
</h4>
<p>
Die Diskette wird initialisiert, die
Sektoren des Inhaltsverzeichnisses muessen mit 0E5H
auf&shy;ge&shy;fuellt werden.
</p>
<h4>
Anpassung BASIC&nbsp;:
</h4>
<p>
Nach dem Initialisieren des Basic ist in die Adresse 1055h-56h anstelle
von FF40h die Adresse BASCAL (sh. Maschinensprache-Schnittstelle)
einzutragen. Vor der Initialisierung des Basics kann BASCAL auch an die
Adresse E335 eingetragen werden (bei BASIC im RAM sinnvoll).
</p>
<h4>
Anpassung anderer Software:
</h4>
<p>
Die Moeglichkeiten, das DOS von
Maschinensprache aus aufzurufen sind gesondert beschrieben.
</p>
<h4>
Hardware Aenderungen:
</h4>
<p>
Neben dem Anschluss des Controllers wird eine kleine Schaltung zur
Ausblendung des Monitor-Roms benoetigt. (Über diese Möglichkeiten
können Sie einiges in <a href="../../../06/01/text/#page">Heft 6</a> nachlesen)&nbsp;.
</p>
<h4>
Fuer EMDOS&nbsp;:
</h4>
<p>
Boot-Eprom&nbsp;&ndash;&gt; Monitor Sockel
</p>
<p>
Ausblendung des Boot-Eproms und
ersetzen durch RAM
entweder statisch oder 4k Page der dynamischen RAM-Karte
</p>
<h4>
Fuer CP/M&nbsp;:
</h4>
<p>
Ersetzen der gesamten unteren 4k Page 0h-
1000h durch RAM
</p>
<p>
Bei Bildschirmzugriffen wird kurzzeitig zurueckgeschaltet.
</p>
<h4>
EMDOS Speicherbelegung:
</h4>
<p>
D000-D100 &nbsp; Puffer frei, solange DOS nicht
aktiv
</p>
<p>
D100 &nbsp; Einsprungpunkt von <span class="uppercase">Nassys</span> aus<br>
</p>
<p style="text-align: left">
D103 &nbsp; Einsprungpunkt fuer DOS-Aufrufe (sh.

<?php columnChangeJustify(2, "</p>", "<p>"); ?>

EMDOS.MAC)
</p>
<p>
D106 <span class="uppercase">Nassys</span>-PHEAS-Aufrufe<br>
E D109 A&nbsp;; HL; DE Register entsprechend
ARG2-ARG4 versorgen und Aufruf von PHEAS (zum Test von PHEAS und zum
direkten Sektorzugriff.)<br>
</p>
<p>
D109 BASCAL Einsprungpunkt von BASIC<br>
</p>
<p>
D10C Sprung zu PHEAS
</p>

<br>

<div class="left uppercase">
<p>
Pheas dient zum Lesen und Schreiben der einzelnen Sektoren
</p>
<p>
entsprechend Sektornummer. Die Diskette besteht aus vielen 256-Bytes
langen logischen Sektoren. Die Gruppengroesse umfasst 4 Sektoren. Bei
CP/M kompatieblen Diskettenformaten muss der Skew Faktor berueckschtigt
werden&nbsp;!
</p>
<h4>
PHEAS Aufrufe&nbsp;:
</h4>
<p>
A= Aufrufsnummer
</p>
<p>
A=0 &nbsp; Init PHEAS (nach Laden aufgerufen)
</p>
<p>
A=1 Abort PHEAS (Interrupt
loeschen, sodass PHEAS geloescht werden kann)
</p>
<p>
A=2 &nbsp; Select Disk (C=Diskno.; HL wird adresse DSB
</p>
<p>
A=3 &nbsp; Sektor Lesen; HL Sektornummer ;Bit 15 = 1&nbsp;: Relativ DE Adresse
Daten
</p>
<p>
A=4 &nbsp; Sektor Schreiben<br>
HL Sektornummer<br>
DE Speicheradresse
</p>
<h4>
DSB &nbsp; Disketten Steuer Block
</h4>
<p>
Fuer jeden Laufwerkstyp einen, Format s.h.
unten
</p>
</div>
<?php imageInsertJrn("Image-20-1.jpeg"); ?>

<?php columnEnd(2); ?>
