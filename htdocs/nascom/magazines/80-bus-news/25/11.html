<?php columnStart(1); ?>
<p>
Patch to MBASIC for HSA-88B support 08-10-85 MACRO-80 3.44 09-Dec-81 PAGE
</p>
<p>
co31
6032
C034
C036
CO3T
6039
cosB
cox
CO3E
co40
co4i
</p>
<p>
C043
045
co46
cO48
CO4A
CO4B
</p>
<p>
co4D
CO4E
C051
C054
C057
COSA
co5B
COSE
co61
</p>
<p>
C064
C066
C068
C069
CO6eB
</p>
<p>
coec
co6D
CO6E
co70
coT2
coT3
COTS
coTe
COTT
co7s8
co79
COTA
co7e
</p>
<p>
18 1D
3B 02
</p>
<p>
18 18
38 03
</p>
<p>
18 13
3B 04
</p>
<p>
18 OF
3E O07
</p>
<p>
18 09
3E OA
</p>
<p>
18 04
</p>
<p>
cp coee
21 0CO4
CD 2837
cD coe6c
</p>
<p>
CD C064
</p>
<p>
CD cosc
03 2BA9
</p>
<p>
D3 81
DB 81
</p>
<p>
38 FB
</p>
<p>
sin:
</p>
<p>
cost
</p>
<p>
tant
</p>
<p>
atnt
</p>
<p>
exp:
</p>
<p>
push af
dr got
ld a2
push af
jr got
la a,3
push af
dr got
14 a,4
push af
jr gol
la a,T
push af
gr gol
ld a,Oah
push af
ir gol
</p>
<p>
1-1
</p>
<p>
} Save command, push operands into Am9511, issue command, read
</p>
<p>
go:
</p>
<p>
gots
</p>
<p>
3; Issue
</p>
<p>
eomnad:
omndO:
</p>
<p>
on em om cm
</p>
<p>
envamd:
</p>
<p>
camds
</p>
<p>
push af
eall cnvamd
id hl,fac
call movrm
eall eonvamd
pop af
call emnd
call cnvms
gp mnovfr
</p>
<p>
Push operand 1
Get 2nd
</p>
<p>
ae ee
</p>
<p>
Pugh it
</p>
<p>
Add command
</p>
<p>
Carry it out
</p>
<p>
Get result
</p>
<p>
Put back in FAC &amp; exit
</p>
<p>
om on ee em em
</p>
<p>
a command and wait for completion
</p>
<p>
out (amd$e),a
in a, (amd$c)
rlea
</p>
<p>
dr c,cmndO
ret
</p>
<p>
Read status
fest busy bit
Loop if so
</p>
<p>
tm em om oe
</p>
<p>
Conversion routine to convert Microsoft Format
to AMDQ511 format, while pushing the value onto
the AMD stack.
</p>
<p>
Number is held in BCDE, with the exponent in B.
</p>
<p>
1d a,b
or a
</p>
<p>
jr BOBS
sub 80h
add aa
ri c
</p>
<p>
rra
</p>
<p>
push af
act
</p>
<p>
1d a,c
rra
</p>
<p>
1d c,amd$d
out (a),e
</p>
<p>
Load exponent
Zero?
</p>
<p>
Remove bias
Shift up
</p>
<p>
Save it
Set MSB of mantissa
</p>
<p>
Point to data port
Send mantissa
</p>
<p>
oman
</p>
<p>
reed
</p>
<p>
Done (Ignore any errors)
</p>
<p>
Get sign of mantissa in carry
Put on front of Exponent
</p>
<p>
Patch to MBASIC
</p>
<p>
COTE
co80
cos2
C083
C085
C086
COBT
COBA
</p>
<p>
cose
COBB
cago
co92
C094
C096
co9T
cogs
CO9A
cooB
co9D
coor
COAt
</p>
<p>
COA2
COM
COAG
COAT
COAA
</p>
<p>
QOAB
</p>
<p>
Macros:
</p>
<p>
Symbols:
90381
COTA
coe6ec
C039
co1s
co4D
28A9
co2Fr
C086
</p>
<p>
ED 51
ED 79
</p>
<p>
AMDSC
</p>
<p>
CRVAMD
cos
FPADD
GO
MOVFR
</p>
<p>
222
</p>
<p>
No Fatal error(s)
</p>
<p>
0080
CO64
cose
c048
C026
cos!
2887
CO3E
</p>
<p>
Bani
</p>
<p>
onvms:
</p>
<p>
codelen
</p>
<p>
AMDSD
CMND
CNYMS
EXP
FPDIV
G01
MOVRM
TAN
</p>
<p>
for HSA--88B support 08-10-83 MACRO-8 3.44 09-Dec-8!1 PAGE 192
</p>
<p>
out (c),4
out (c),a
pop af
out (c),a
ret
</p>
<p>
push af
</p>
<p>
id de,O
ar cand
</p>
<p>
Recover exponent
Send it
</p>
<p>
Done
</p>
<p>
Set 0 on stack
ensure DE isa 0
</p>
<p>
we em em em em
</p>
<p>
Routine to read a result back from the AMD9511, and
to convert it to Microsoft format.
</p>
<p>
1d c,amd$d
in&nbsp;.a,(e)
in \b,
</p>
<p>
in
in
ld
ld
rl
add
rr
sra
add
ld
in a, (amd$c)
and 20h
</p>
<p>
ret z
</p>
<p>
ld be,0
</p>
<p>
ret
</p>
<p>
Data port
Get Exponent + Mantisaa sign
Get mantissa
</p>
<p>
Bo
</p>
<p>
aN
oo 8
ete
</p>
<p>
Get to correct place
</p>
<p>
*
</p>
<p>
*
</p>
<p>
Get rid of leading 1
replace by Mantisaa sign
</p>
<p>
Extended Exponent sign while
Replace the bias Guthag
Put in B
</p>
<p>
Check if was 0
</p>
<p>
Zero?
</p>
<p>
No, done
</p>
<p>
Yes, flag it
</p>
<p>
Done.
</p>
<p>
a
os 6
oococ ons og of
</p>
<p>
-dephase
</p>
<p>
equ $-ttt Ho. of bytes to move
</p>
<p>
end
</p>
<p>
C043 ATN
C066 CMNDO
OOAB CODSLEN
oco4 FAC
co22 FPMPY
CO2A LOG
C034 SIN
oooc&rsquo; ttt
</p>
<p>
11
</p>
<?php columnEnd(1); ?>
