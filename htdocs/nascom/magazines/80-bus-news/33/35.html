<?php columnStart(1); ?>
<p>
SCRAMBLE
</p>
<p>
01 8D
0190
0194
0198
O1g9c
01A0
</p>
<p>
O1A4
OLAS
O1A7
OLAA
O1AD
O1LBO
01B3
</p>
<p>
O1B6
O1B6
O1B7
O1B8
O1B9
01BB
OLBE
O1Ccl
01C2
01c3
01c4
01Cc5
O1C8
O1CB
OLCF
01D3
OLD7
O1DB
O1DB
OLDE
O1E2
O1B6
OLEA
OEE
O1F2
O1F6
OLFA
OLFC
0200
0204
0208
</p>
<p>
cD
2B
6F
63
69
20
</p>
<p>
cD
DA
cD
cD
cD
c3
</p>
<p>
cS
DS
ES
10)
ll
cD
El
DL
cl
3G
CA
cD
2B
</p>
<p>
6F
20
</p>
<p>
cD
28
6c
20
oF
20
65
66
6E
75
6F
63
69
</p>
<p>
M-80
Program to scramble CP/M files using an 8-bit password.
</p>
<p>
03A8
2B 20
20 73
68 20
6C 65
2B 2B
</p>
<p>
0212
O1B6
0253
0260
02C1
O1A4
</p>
<p>
10
005c
0005
</p>
<p>
O1DB
O3A8
2B 20
6C 20
6E 65
2B 2B
</p>
<p>
0348
</p>
<p>
6F 73
65 72
72 20
66 69
20 6C
74 20
</p>
<p>
6E 6B
77 66
6F 6E
</p>
<p>
4E
75
66
2E
24
</p>
<p>
64
2E
24
</p>
<p>
43
65
72
2D
6c
65
69
</p>
<p>
6E
20
64
6F
</p>
<p>
14 Oct 1984
</p>
<p>
call
defb
</p>
<p>
\
</p>
<p>
20:45 PAGE 1-3
</p>
<p>
exit
&ldquo;++ No such file. ++$7
</p>
<p>
; Read the file, scramble a sector, re-write it.
</p>
<p>
scramlp:
call
ip
call
call
call
jp
</p>
<p>
finish: cpm
push
push
push
ld
ld
eall
pop
pop
pop
ine
dp
call
defb
</p>
<p>
tee ete tats
</p>
<p>
finishi:
call
defb
</p>
<p>
defb
</p>
<p>
All done ...
</p>
<p>
&laquo;+&raquo; On a &ldquo;normal&rdquo; cp/m system, we wouldn&rdquo;t have to do
anything, because we re-wrote in place. However, for
such systems as the NorthStar CP/M, we must
</p>
<p>
explicitly close the file, because the write to the
directory will cause the clever Lifeboat-designed BIOS
to flush it&rsquo;s memory-resident disk buffers.
</p>
<p>
rdsect
c,finish
scrambl
backup
wrsect
scramlp
</p>
<p>
Read a sector
</p>
<p>
Exit loop if eof
Scramble it
Re-position for write
Re-write the sector
Loop until eof
</p>
<p>
close&nbsp;,fcb
</p>
<p>
be
</p>
<p>
de
</p>
<p>
hi
</p>
<p>
c,close
</p>
<p>
de,feb
</p>
<p>
bdos
</p>
<p>
hl
</p>
<p>
de
</p>
<p>
be&nbsp;.
a 3; This better work..
z,finishl
</p>
<p>
exit
</p>
<p>
&ldquo;++ All done. ++$&rdquo;
</p>
<p>
exit
&ldquo;++ Close error &ndash; file left in &rdquo;
</p>
<p>
&ldquo;unknown condition. ++$7
</p>
<p>
SCRAMBLE
</p>
<p>
020c
0210
</p>
<p>
0212
0212
0213
0214
0215
0217
O21A
021D
O21E
021F
0220
0221
</p>
<p>
0222
0224
0225
0226
0229
022D
0231
0235
0239
023D
0241
0245
0249
024D
0251
</p>
<p>
0253
0253
0256
0259
025A
025B
025c
02 5F
</p>
<p>
0260
0263
0264
0267
</p>
<p>
0268
026B
026C
</p>
<p>
6E
23
</p>
<p>
FE
37
cs
cD
2B
65
65
72
66
20
20
64
72
64
2B
</p>
<p>
3A
3D
32
FO
</p>
<p>
3A
3D
32
</p>
<p>
M-80
Program to scramble CP/M files using an 8-bit password.
</p>
<p>
2E 20 2B
</p>
<p>
24
</p>
<p>
14
</p>
<p>
005c
0005
</p>
<p>
ol
</p>
<p>
0348
</p>
<p>
2B
61
72
20
69
</p>
<p>
62
65
6F
2E
24
</p>
<p>
20
64
72
</p>
<p>
6C
61
65
73
79
20
</p>
<p>
0080
O2F8
</p>
<p>
0256
</p>
<p>
007c
</p>
<p>
007c
</p>
<p>
0068
</p>
<p>
0068
</p>
<p>
52
20
6F
20
65
79
20
74
65
2B
</p>
<p>
14 Oct 1984
</p>
<p>
20:45 PAGE
</p>
<p>
3; Sector read routine
</p>
<p>
rdsect: cpm
push
push
push
ld
</p>
<p>
ld
</p>
<p>
eall
pop
pop
pop
or
</p>
<p>
ret
</p>
<p>
te teetete te
</p>
<p>
5; Read error or
cp
set
ret
eall
defb
</p>
<p>
defb
</p>
<p>
read&nbsp;,fcb
be
</p>
<p>
de
</p>
<p>
hl
c,read
de,fcb
bdos
hl
</p>
<p>
de
</p>
<p>
be
</p>
<p>
a
</p>
<p>
z
</p>
<p>
eof
1
</p>
<p>
exit
</p>
<p>
1-4
</p>
<p>
All Ok
</p>
<p>
eofu
Carry shows eof
ret, carry set
</p>
<p>
&ldquo;++ Read error &ndash; file may be *
</p>
<p>
&ldquo;destroyed. ++E&para;
</p>
<p>
3; Seramble the sector
</p>
<p>
scrambl:
ld
serlp: call
xor
ld
ine
</p>
<p>
jp
</p>
<p>
ret
</p>
<p>
hl, 80h
pseuran
(hl)
Chi),a
1
</p>
<p>
nz,scerlp
</p>
<p>
3; Backup the file pointer for the
</p>
<p>
backup: ld
dec
1d
ret
</p>
<p>
a,(febrno)
a
Cfebrno) ,a
p
</p>
<p>
,
fy
</p>
<p>
Point to sector
Get pseudo random &pound;
Scramble
</p>
<p>
More in sectoru
</p>
<p>
re-write
Get sector &pound;
Back up
</p>
<p>
Return if Ok
</p>
<p>
3 We backed up into previous extent, will have
</p>
<p>
to re-open it
ld
dec
ld
</p>
<p>
a,(febext)
a
Cfcbext),a
</p>
<p>
3
x
</p>
<p>
Get extent
Back up |
</p>
<p>
35
</p>
<?php columnEnd(1); ?>
