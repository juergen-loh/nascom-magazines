<?php columnStart(2, 2); ?>
<div class="indent">
<p>
<b>.pa</b> (Page break/go to next record)
</p>
<p>
Avery useful command which instructs the
program to insert a page throw and go on to
use the next record in the data file.
</p>
<p>
<b>.rv</b> &lt;list of variable(s)&gt; (Read a variable)
</p>
<p>
This specifies what data fields are in the data
file, and their order.
</p>
</div>
<p>
The standard letter will have data fields inserted
into it and bracketed by ampersands (&amp;); by
placing a /O at the end of a data field, one can
suppress the space which would be left by any field
such as a missing post code or county which may
have been omitted from the data file.
</p>
<p>
Three or four dot commands are required for all
letters which will be processed by MailMerge.
These are .op (optional), .df, followed by .rv and
.pa; the first three are placed at the beginning of
the letter file and .pa at the end. A typical letter file
would be as follows, where the dot commands
should always start in column 1.
</p>
<?php imageInsert($imagepath, $magpath, $issuepath, $pagepath, "Image-19-1.png"); ?>
<p>
File this as BEGGING.LET.
</p>
<p>
Then set up a data file with the names and
addresses of all the firms you wish to bother. Use
the <b class="uppercase">Non-Document</b> mode of WordStar for this.
The data must be present in the same order as it is
required by the letter file and if any information
such as the name of the street, or the county is
missing, its place in the data file must be marked
with a comma. Each name and address must take
up one line of the file and is terminated with a
carriage return&nbsp;&ndash; the record may be well over 200
characters long. The following example will show
how it is done:
</p>
<pre>
Top Cat,Tiger Computers,Zoo Road,Panthertown,Lynx,
ZZ1 1ZZ,mice,pl86
Deputy Dawg,Newbone Computer Store,,Wulf,
Avon,,floppy disks,pl86
Chris Tandocri,Beebac,,Oxbridge,,0X99 BBC,
plastic computers,pl86
</pre>
<p>
Store it as SILLY.DTA
</p>
<p>
Note that record 1 is complete, record 2 has no
street name, or postcode, hence the double
commas after Store and Avon, and record 3 has no
street name or county, hence two lots of double
commas.
</p>
<p>
The command file comes next.
</p>
<p>
In Non-document mode type the following, noting
that the dot commands must start in column 1.
</p>
<pre>
.cs
   .dm Printing your letters
   .av Date
   .fi BEGGING.LET
   .dm Finished (Thank goodness!) - or
whatever you want to say.
</pre>
<p>
File this as DAFT.CMD
</p>
<p>
You now have three files, BEGGING.LET, SILLY.DTA
and DAFT.CMD &mdash; and you are ready to try
out the all singing, dancing and generally frolicsome
<span class="uppercase">Mailmerge</span>!
</p>
<p>
Connect the printer, and select M from the
WordStar menu. The program will prompt you for
the name of the file to merge/<?php spChar("zwsp"); ?>print. In the example
given above, this is DAFT.CMD. You then have to
give some simple answers to profound questions
about the output. If you want to, you can save the
results of your labours in another file; MailMerge
prompts you for the name. Otherwise, the default
settings will be quite satisfactory for a trial run.
Don&rsquo;t make the mistake of specifying more than 1
copy, since this means that MailMerge will go on
churning out as many sets of letters as you have
asked for copies!
</p>
<p>
Having established a reasonably simple format for
the use of MailMerge, I have found it quite easy to
use, although a minor bug sometimes manifests
itself. If one creates new data, letter or command
files using WordStar and then uses MailMerge
without exiting to the system, and re-entering
WordStar, the whole system may lock up, and has
to be reset.
</p>
<?php hline("100%", 2); ?>
<?php columnEnd(2); ?>
