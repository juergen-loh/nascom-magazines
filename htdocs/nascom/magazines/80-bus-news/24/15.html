<?php columnStart(1); ?>
<p>
MV256 Relocating Graphics Drivers
Disk read/<?php spChar("zwsp"); ?>write routines for MV256
</p>
<p>
OBIF
OB21
OB22
OB23
OB25
0B28
OB29
OB2C
OB2E
B31
</p>
<p>
OB34
0B36
OB39
OB3A
OB3B
OB3D
</p>
<p>
OB40
OB42
OB43
</p>
<p>
OB46
OB48
</p>
<p>
OB49
OB4B
OB4E
OB4F
OBS1
OB53
OB54
OBS5
OB56
OBS7
OB59
OB5B
OBS5D
OBSF
OB61
</p>
<p>
OBG64
OBE6
OB67
</p>
<p>
OBGA
OB6B
OB6C
OBED
OBGF
OB70
</p>
<p>
20
i
cb
</p>
<p>
D3
cg
</p>
<p>
06
4
AF
D3
</p>
<p>
1A
13
</p>
<p>
5F
cB
CB
cB
CB
&pound;6
ep
</p>
<p>
D3
1c
cD
</p>
<p>
23
7c
BS
20
Dt
cg
</p>
<p>
C2
0000
</p>
<p>
0080
1A
0005
oces
14
9005
</p>
<p>
05
OB49
</p>
<p>
O8EO
c2
</p>
<p>
0080
</p>
<p>
3
</p>
<p>
OB7B
</p>
<p>
M-80
</p>
<p>
3 Main load down loop
</p>
<p>
GU1:
</p>
<p>
GL2:
</p>
<p>
GL3:
</p>
<p>
en ON Om bed
</p>
<p>
GL:
</p>
<p>
LGhe:
</p>
<p>
LGL3:
</p>
<p>
IN
PUSH
XOR
out
LD
PUSH
LD
LD
CALL
LD
R
</p>
<p>
LD
CALL
POP
OR
oR
CALL
R
</p>
<p>
JR
POP
CALL
R
OUT
RET
</p>
<p>
A, (CNTL2)
AF
</p>
<p>
A
(ONTL2),A
HL,O
</p>
<p>
HL
</p>
<p>
DE, TBUF
C, SETDMA
BDOS
DE,FCB ;
</p>
<p>
C,RDFL
BDOS
HL
</p>
<p>
A
NZ,GL3
LGLi
</p>
<p>
NZ,GL2
AF
READY
</p>
<p>
(CNTL2),A
</p>
<p>
Get a
</p>
<p>
20 Jun 1983
</p>
<p>
an ee
</p>
<p>
\
</p>
<p>
23:54 PAGE 1-3
</p>
<p>
Get the current line
style and save it
Set continuous style
</p>
<p>
Set HL to (X,Y) = 0,0
Save the screen pointer
Set DMA to TBUF start
</p>
<p>
record into TBUF
</p>
<p>
on
</p>
<p>
,
</p>
<p>
Get screen pointer back
Test for end of file
Yes, skip screen write
Write TBUF to screen
</p>
<p>
Go and get some more
Get the line style back
</p>
<p>
Go home
</p>
<p>
Load a buffer full to the screen
The
</p>
<p>
four MSBs of each byte represent 1 to 16 points
LSBs rep. the colour.
</p>
<p>
LD
LD
XOR
OUT
ouT
LD
Inc
PUSH
LD
SRL
SRL
SRL
SRL
AND
CALL
</p>
<p>
ouT
INC
CALL
</p>
<p>
Inc
LD
OR
</p>
<p>
POP
RET
</p>
<p>
B,128
DE, TBUF
A
(Yom), A
(xem), A
A, (DE)
DE
</p>
<p>
DE&rdquo;
</p>
<p>
yA
</p>
<p>
fm he O
</p>
<p>
FH
READY
</p>
<p>
(PENCOL),A
E
pcoL
</p>
<p>
HL
AH
</p>
<p>
L
</p>
<p>
NZ, LGLA
DE
</p>
<p>
of the same colour. The four
</p>
<p>
Here ee om
</p>
<p>
nae
</p>
<p>
Set count to 128 bytes
Point to buffer
Set X &amp; Y MSBsa to 0
</p>
<p>
Get a byte
</p>
<p>
Point to next
</p>
<p>
Save the pointer
</p>
<p>
Get pixel count in B
</p>
<p>
Get the colour in A
Send the colour
</p>
<p>
Fudge the pixel count
Put a colour at X,Y
</p>
<p>
Point to next pixel
Test for end of screen
</p>
<p>
Go home regardless if end
Get DE off the stack
</p>
<p>
MV256 Relocating Graphics Drivers
</p>
<p>
M-80 20 Jun 1983
</p>
<p>
Disk read/<?php spChar("zwsp"); ?>write routines for MV256
</p>
<p>
OB71
OB72
OBT74
OB75
OBT77
OB78
OBTA
</p>
<p>
OB7B
</p>
<p>
OBTE
OBTF
OBS
OB82
OB84
</p>
<p>
OB87
OB89
OBSB
</p>
<p>
OBSE
</p>
<p>
OB91
oBg2
0B93
OB94
</p>
<p>
OB96
OB97
OB98
OB99
OB9A
OB9B
OB9C
</p>
<p>
OB9E
OBA
OBA
</p>
<p>
OBA5
OBA8
OBAA
</p>
<p>
OBAD
OBAF
OBBI
OBB2
OBB3
</p>
<p>
1D
20
D1
10
3T
cB
cg
</p>
<p>
cD
</p>
<p>
06
iM
</p>
<p>
AF
12
13
10
</p>
<p>
48
23
5E
23
56
D5
DD
</p>
<p>
DD
FE
20
</p>
<p>
DD
D6
32
</p>
<p>
DD
DD
oD
oD
18
</p>
<p>
LGL4; DEC B
F3 JR NZ, LGL3
POP DE
De DINZ LGL2
Scr
iF RR A
RET
</p>
<p>
An gn oe em tw
</p>
<p>
; Plot a pixel at HL (X,Y)
PCOL: CALL READY
R
LD A,H
cB our (ycL),A
LD A\L
cg our (XCL),A
CALL READY
R
80 LD
co out
RET
</p>
<p>
O8E0
</p>
<p>
A, 80H
(CMD) ,A
</p>
<p>
; Unscramble an FCB name from the
3; and place in FCB for use.
24 FCBi: LD B,36
oce6s LD DE, FCB
R
XOR A
FOBIA: LD (DE),A
TNC DE
FC DINZ POCBIA
; Get the pointers
LD Cc, (HL)
INC HL
LD 8, (HL)
Inc HL
LD D, (HL)
PUSH DE
HH POP Ix
; Test if colon present in second
7E 01 LD A, (1X+1)
34 cp wen
10 JR
</p>
<p>
NZ, PCB2
</p>
<p>
23:54 PAGE qa4
</p>
<p>
Count a pixel
</p>
<p>
Same colour, round again
Get TBUF pointer back
More in TBUF? Round again
Fudge the Z flag off
</p>
<p>
TBUF empty, so go home
</p>
<p>
Send H and L to Y and X
</p>
<p>
Plot point command
</p>
<p>
atring pointer in HL
</p>
<p>
Clear out FCB
</p>
<p>
Get the string length
</p>
<p>
Get pointer to
atring into Ik
</p>
<p>
byte
</p>
<p>
; If colon, put drive number in FCB
</p>
<p>
TE 00 LD A, (1X)
40 SUB 40H
oces LD (FCB) ,A
R
23 INC IX
23 INC Ix
DEC c
DEC c
04 JR FCB3
</p>
<p>
oe an ee
</p>
<p>
Get drive letter
Convert to number
Put in FCB
</p>
<p>
Point past the drive
letter and colon
</p>
<p>
Dec the string count
appropriately
</p>
<p>
15
</p>
<?php columnEnd(1); ?>
