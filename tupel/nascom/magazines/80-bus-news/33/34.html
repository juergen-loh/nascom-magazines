<?php columnStart(1); ?>
<p>
SCRAMBLE M80 14 Oct 1984 20:45 PAGE 1-1
Program to scramble CP/M files using an 8-bit password.
if 2q eq &ldquo;*&rsquo;*
local 2b&nbsp;,2z
call 22
2b: defb 7&pound;
la: pop hi 3 Get from
ld be&nbsp;,2?z-?b 3 Get len
else
1d hl&nbsp;,?7&pound;
endif
endif
if not nul&nbsp;?t
ld de,?t
endif
if not nul 71
ld be&nbsp;,?71
endif
call mover
mf defl -l ; Show expansion
endm
</p>
<p>
3 Define CP/M macro &ndash; cpm fne,parm
epm macro 2&pound;,2p
push be
push de
push hl
if hot nul 7&pound;
ld c,7f
endif
if not nul&nbsp;?p
ld de,?p
endif
call bdos
pop hi
pop de
pop be
endm
</p>
<p>
00007 aseg
org 100h
</p>
<p>
3 Start of program execution
0100 cD 0122 call start
0103 OD OA 53 43 defb cr,1f,&rsquo;SCRAMBLE as of *
0107 52 41 4D 42
O10B 4C 45 20 61
OLOF 73 20 6F 66
0113 20
o114 31 33 2F defb
OLL7 31&rsquo;30 2F defb
OLIA 38 34 2E defb
O1ID OD OA OD OA defb
0121 24
</p>
<p>
&lsquo;0&rsquo;+day/10,&rsquo;0*+day mod 10,&rsquo;/7
&lsquo;O&ldquo;+month/10,&rsquo;O*+month mod 10,7/7
&lsquo;O&rsquo;+year/10,&rsquo;O"+year mod 10,7 .7
ev,lf,er,1f&pound;,&rsquo;$&rdquo;
</p>
<p>
0122 dL start: pop de ; Get id
0123 OE 09 ld c,print
0125 cD 0005 call bdos 5 Print ic
</p>
<p>
&gt;
</p>
<p>
SCRAMBLE
Program to scramble CP/M files using an 8-bit password.
</p>
<p>
0128
012B
012c
012F
</p>
<p>
0132
0134
0137
0138
</p>
<p>
013B
O13E
0140
0143
0146
O14A
014E
0152
0156
015A
OLSE
</p>
<p>
0162
0162
0165
0168
0168
</p>
<p>
016E
O171
0173
0173
OL76
0177
0178
</p>
<p>
OL7B
OL7C
017D
OL7E
0180
0183
0186
0187
0188
0189
018A
</p>
<p>
21
39
22
31
</p>
<p>
26
cp
25
C2
</p>
<p>
3A
FE
c2
cD
2B
61
6F
6E
38
74
20
</p>
<p>
21
ll
01
</p>
<p>
21
06
</p>
<p>
cD
23
05
C2
</p>
<p>
c5
</p>
<p>
ES
OE
11
cD
El
</p>
<p>
cl
3c
c2
</p>
<p>
0000
</p>
<p>
0407
0407
</p>
<p>
00
</p>
<p>
02F8
</p>
<p>
0134
</p>
<p>
0074
</p>
<p>
0162
03A8
</p>
<p>
2B
73
72
6F
</p>
<p>
65
2B
</p>
<p>
20
73
64
74
62
73
2B
</p>
<p>
006D
O3BF
0008
039D
</p>
<p>
O3BF
</p>
<p>
08
</p>
<p>
0313
</p>
<p>
0173
</p>
<p>
OF
</p>
<p>
005c
0005
</p>
<p>
0144
</p>
<p>
M=80
</p>
<p>
50
77
20
20
79
2E
24
</p>
<p>
14 Oct 1984
</p>
<p>
20:45 PAGE 1-2
</p>
<p>
3 Init. local stack
</p>
<p>
1d
add
1d
ld
</p>
<p>
hi,0
</p>
<p>
hl&nbsp;,sp
(stack) ,hl
sp,stack
</p>
<p>
3; Scramble a while to mix up the seed
</p>
<p>
ld
mixup: call
</p>
<p>
dec
</p>
<p>
jp
</p>
<p>
h,O0 3 Get 256 &pound;%s
pseuran 3 Get aft
</p>
<p>
h ; More?
</p>
<p>
nz mixup ; Loop if so
</p>
<p>
; See that the password is 8 characters
</p>
<p>
ld
ep
jp
call
defb
</p>
<p>
a,( feb2+8)
</p>
<p>
ng&nbsp;,pwis8
exit
&ldquo;++ Password not 8 bytes. ++$&rdquo;
</p>
<p>
3; Save the password
</p>
<p>
pwis8: move
ld
1d
1d
call
</p>
<p>
t+ t+
</p>
<p>
ld
ld
duptest:
call
inc
dec
ip
</p>
<p>
fcb2+1, passwd&nbsp;,8
hi&nbsp;,feb2+1
</p>
<p>
de, passwd
</p>
<p>
be&nbsp;,8
</p>
<p>
mover
</p>
<p>
Password is 8 bytes, now make sure no character
is repeated more than 2 times
</p>
<p>
hl&nbsp;,passwd
b,8 3; 8 chars to test
</p>
<p>
hi To next char
b
nz&nbsp;,duptest
</p>
<p>
ekdup 3; Aborts if 3 = chars
3
</p>
<p>
3; See that the input file exists
</p>
<p>
cpm
push
push
push
ld
ld
call
pop
pop
pop
ine
ip
</p>
<p>
tee tetgte
</p>
<p>
open, feb
</p>
<p>
be
</p>
<p>
de
</p>
<p>
hl
</p>
<p>
c,open
</p>
<p>
de,fcb
</p>
<p>
bdos
</p>
<p>
hl
</p>
<p>
de
</p>
<p>
be
</p>
<p>
a 3 Ok?
nz,scramlp 5; Yes, seramble the file
</p>
<?php columnEnd(1); ?>
