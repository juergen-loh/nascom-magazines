<?php columnStart(1); ?>
<p>
SCRAMBLE
</p>
<p>
Program to scramble CP/M files using an
</p>
<p>
026F
0270
0271
0272
0274
0277
0274
02738
027c
027D
027E
0281
0284
0288
028c
0290
0294
0298
029C
0240
02A3
02a7
O2AB
O2AF
0283
02B7
028B
02BB
02BD
02C0
</p>
<p>
02ci
O2C1
02C2
0203
0204
02c6
02c9
02cc
02cD
02CE
O2CF
o2D0
02D1
02D4
02D8
o2DC
02E0
02E4
Q2E8
O2EC
O2FO
O2F4
</p>
<p>
5
DS
BS
OE
ll
cD
EL
DL
cl
x
C2
cD
2B
65
65
67
74
20
6C
2D
20
69
69
6C
65
20
</p>
<p>
35
32
i)
</p>
<p>
cs
DS
E5
</p>
<p>
li
</p>
<p>
D1
ci
</p>
<p>
C8
cD
2B
72
20
6F
20
65
6F
72
20
</p>
<p>
OF
</p>
<p>
M-80
</p>
<p>
005cC
0005
</p>
<p>
O2BB
03A8
</p>
<p>
2D
65
20
65
66
65
oD
20
6c
73
6F
72
2B
</p>
<p>
TE
</p>
<p>
20
6F
69
65
6E
61
64
0A
20
65
20
62
65
23
</p>
<p>
007c
</p>
<p>
15
</p>
<p>
005c
0005
</p>
<p>
0348
</p>
<p>
2B
69
65
72
66
20
62
65
2B
</p>
<p>
20
74
72
20
69
63
62
64
2B
</p>
<p>
70
6E
78
74
69
20
</p>
<p>
66
20
63
</p>
<p>
64
24
</p>
<p>
5u
65
72
2D
6c
</p>
<p>
65
25
24
</p>
<p>
14 Oct 1984
</p>
<p>
eeetetete
</p>
<p>
open2ok:
</p>
<p>
cpm
push
push
push
ld
ld
call
pop
pop
pop
ine
dp
call
defb
</p>
<p>
defb
</p>
<p>
ld
1d
ret
</p>
<p>
20:45 PAGE 1-5
8=bit password.
</p>
<p>
open,feb 3 Re-open
be
</p>
<p>
de
</p>
<p>
hi
</p>
<p>
c,open
</p>
<p>
de,feb
</p>
<p>
bdos
</p>
<p>
hi
</p>
<p>
de
</p>
<p>
be
</p>
<p>
a
</p>
<p>
nz&nbsp;,open2ok
</p>
<p>
exit
</p>
<p>
&ldquo;++ Re-opening extent fatled -",cr,1f
</p>
<p>
* file is clobbered ++$&rsquo;
</p>
<p>
a,7&pound;h
Cfebrno) ,a
</p>
<p>
3 Get hi sector
</p>
<p>
3 Write back the sector
</p>
<p>
wrsectt
</p>
<p>
te teeta te +
</p>
<p>
cpm
push
push
push
ld
ld
eall
pop
pop
pop
or
ret
call
defb
</p>
<p>
write, feb
be
</p>
<p>
de
</p>
<p>
hi
e,write
de,feb
bdos
</p>
<p>
hl
</p>
<p>
de
</p>
<p>
be
</p>
<p>
a
</p>
<p>
Zz
</p>
<p>
exit
</p>
<p>
&ldquo;++ Write error &ndash; file clobbered. ++$7
</p>
<p>
SCRAMBLE
</p>
<p>
02F8
02F8
O2FA
O2FA
O2FC
O2FF
0300
0300
0301
0302
0303
0304
0305
</p>
<p>
0308
0309
030A
0308
030c
030D
0305
0310
0313
0314
0315
0316
O317
O31A
</p>
<p>
031B
O31D
0320
0322
0323
0324
0325
0328
0329
032C
032F
0332
0336
033A
033E
0342
0346
0344
034E
0352
0356
</p>
<p>
OE
</p>
<p>
06
ll
B7
</p>
<p>
1A
iF
12
13
05
c2
</p>
<p>
1B
iF
iF
EB
AE
OF
E6
21
B6
77
EB
oD
c2
cy
</p>
<p>
OE
ll
3E
F5
1A
BE
C2
oD
c2
32
cD
2B
6F
61
74
6D
61
61
6F
74
20
</p>
<p>
M-80
Program to scramble CP/M files using an E&para;-bit password.
</p>
<p>
04
</p>
<p>
08
O3BF
</p>
<p>
0300
</p>
<p>
O3BF
</p>
<p>
O2FA
</p>
<p>
03
O3BF
</p>
<p>
0396
</p>
<p>
0396
0381
0348
2B 20
</p>
<p>
72 61
65 72
61 79
70 70
72 20
72 65
68 61
</p>
<p>
68
63
20
20
65
6D
20
6E
69
</p>
<p>
14 Oct 1
</p>
<p>
3
;
5
;
pseuran:
</p>
<p>
pseulp0:
</p>
<p>
pseulpl:
</p>
<p>
984
</p>
<p>
20:45
</p>
<p>
PAGE 1-6
</p>
<p>
Get a pseudo-random 8 bit number using the password
as a seed.
</p>
<p>
For speed, this routine does no register
pushes and pops, however hl isnt used.
</p>
<p>
1d
</p>
<p>
ld
1d
or
</p>
<p>
ld
rra
id
inc
dec
</p>
<p>
jp
</p>
<p>
c,4
</p>
<p>
b,8
de, passwd
a
</p>
<p>
a,(de)
</p>
<p>
(de) ,a
</p>
<p>
de
</p>
<p>
b
nz,pseulpl
</p>
<p>
Grab every 4th pseu. &pound;
Shift thru 8 bytes
Clear initial carry
</p>
<p>
Get a char
Shift
</p>
<p>
; Exclusive-or the last few bits into the first one
</p>
<p>
dec
rra
rra
ex
xor
rrea
and
ld
or
ld
ex
dec
jp
ret
</p>
<p>
de 3
</p>
<p>
de,hl
Chl)
</p>
<p>
80h
</p>
<p>
hl&nbsp;, passwd
Chl)
</p>
<p>
Chl) ,a
de,hi
</p>
<p>
c
nz,pseul pO 3
</p>
<p>
BRR en ak a om
</p>
<p>
5; Routine to check for duplicate c
</p>
<p>
ckdup:
</p>
<p>
ckdl p:
</p>
<p>
ld
ld
ld
push
ld
cp
jp
dec
ip
1d
eall
defb
</p>
<p>
defb
</p>
<p>
c,3 3
de, passwd
a,8
</p>
<p>
af
</p>
<p>
a,(de)
(hl)
</p>
<p>
ng&nbsp;,ckndup
c
nz,ckndup
(dupchar) ,a ;
exit
</p>
<p>
ER OR em on
</p>
<p>
&ldquo;++ No character may appear more
</p>
<p>
&ldquo;than twice in the
</p>
<p>
Back up to last
</p>
<p>
Shift a few more
</p>
<p>
Shift lo bit into hi
Isolate single bit
Get first byte
</p>
<p>
&ldquo;or&rdquo; in the bit
</p>
<p>
Move it back
</p>
<p>
Restore hi
</p>
<p>
Loop if more passes
hars in password
Dup char counter
Char count
</p>
<p>
Save count
</p>
<p>
Get char
</p>
<p>
Dupu
</p>
<p>
Count dups
</p>
<p>
Save for print
</p>
<p>
*
</p>
<p>
password.&rdquo; ,cr,1f
</p>
<p>
36
</p>
<?php columnEnd(1); ?>
