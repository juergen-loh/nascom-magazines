<?php columnStart(2, 2); ?>
<p>
weOOT EQU 0 CHKSH: INC HL :CHECK EACH SWITCH
FDOS EQU 5 LD A, (HL)
FCB EQU 5CH cP Bt
CBUFF EQU 80H JR NZ, CHKC
SET BSWTCH, (IX) :SET COUNT BLANK LINES
RCONF EQU 1 JR NXTSH
WCONBF EQU 9 CHKC: CP &lsquo;c!
DELF EQU 19 JR NZ, CHKF
SET CSWICH,(IX) :SBT COMPLETE LINE
BEL EQU 07H JR NXTSW
LF EQU OAH CHKF: CP OF
CR EQU ODH JR NZ, CHKL
ES EQU 1BH SET FSWICH, (1X) ;SET FINISH OF LINE
WILD = EQUS&rsquo;?! JR NXTSW
CHKL: CP &lsquo;LI!
LD (STK), SP SAVE CCP STACK POINTER JR NZ, CHKN
LD SP, STK SET UP STACK LD A,B CHECK NO CHARS LEFT IN COMMAND LINE
XOR A SINITIALISE SWITCHES cP 3
LD IX, SWICH JP C, REPORT :IF NOT ENOUGH FOR Lad
LD (IX),A CALL DIGIT PICK UP MS DIGIT
INC A &lsquo;SET DEFAULT L SWITCH LINE NO LD CLA &lsquo;C= A * 10
LD (LIN),A ADD A.A
CALL GETCUR :GET CURRENT POSITION OF CURSOR ADD ALA
LD (CURPOS),HL AND SAVE IT ADD A,C
LD DE, CMDFAL :CHECK THAT A STRING HAS BEEN ADD A.A
LD HL, CBUFF ; SUPPLIED LD OC.A
LD B, {HL} NO. CHARS IN COMMAND LINE CALL DIGIT &lsquo;PICK UP LS DIGIT
LD A,B ADD A.C ADD IN MS DIGIT
cp 2 &ldquo;AT LEAST THE SEPARATING SPACE AND &lsquo; LD (LIN),A STORE LINE COUNT
JP C,REPORT &lsquo;IF TOO SHORT A STRING SUPPLIED JR NXTSW
INC HL CHKN: CP &lsquo;N!
INC HL JR NZ, CHKS
LDA, (HL) SET NSWICH, (IX) ;SET NOT CONTAINED IN
cp orth JR NXTSW
JP NZ,REPORT -IF NO LEADING &lsquo; CHKS: CP &lsquo;St
LD OL,B &ldquo;PICK UP LAST CHAR IN COMMAND LINE JR NZ, CHKU
LD H,0 SET SSWICH,(IX) ;SET START OP LINE
LD BC, CBUFF JR NXTSW
ADD HL,BC CHKU: cP &lsquo;US
CHKSTR: LD A,(HL) | :SEARCH BACK FOR TRAILING &ndash; JR NZ, CHKW
DEC HL SET USWTCH, (IX) :SET CONVERT TO UPPER CASE
1 JR NXTSW
JR NZ, CHKSTR LIF NOT | CHKW: CP ow
INC HL &lsquo; JP NZ, REPORT
LD A,L :CALCULATE LENGTH OF STRING SET WSWICH, (IX) ;SET&nbsp;? AS WILD CARD
SUB CBUFF+3 NXTSW: DJNZ CHKSW :IF MORE SWITCHES
JP C,REPORT IF NO TRAILING &lsquo; RUN: LD HL,(CURPOS} CURSOR POSITION
LD (STRLEN),A AND SAVE FOR MATCH COUNT DEC L&nbsp;. START PROM COMMAND LINE
LD A, (CBUFF} CHECK SWITCHES BACK: DEC L BACK A LINE
ADD A, CBUFF JP P, CHEK &lsquo;IF NOT OFF TOP OF SCREEN
SUB OL LD HL, (CURPOS) &lt;RESTORE CURSOR TO ORIGINAL POSN
JR Z,RUN LIF NO SWITCHES SUPPLIED CALL PUTCUR
cp LD DE, TOPFAL
JP C,REPORT IF COMMAND TOO SHORT JP REPORT
LD BLA &lsquo;SAVE NO. SWITCHES + 1 CHEK: CALL PUTCUR :ELSE POSITION CURSOR
INC HL &ldquo;PICK UP SWITCH SEPARATOR CALL GETLIN &lsquo;GET LINE FROM SVC
LDA, (HL) BIT BSWTCH, (IX) :CHECK COUNT BLANK LINE SWITCH
cpt JR NZ,CLIN LIF YES COUNT LINE
JP -NZ,REPORT LIF NOT / LD ALC &lt;CHECK LENGTH OF LINE
DEC B &ldquo;NO. OF SWITCHES OR A
</p>
<p>
JR 2Z,BACK ;IF EMPTY LINE
</p>
<?php columnEnd(2); ?>
