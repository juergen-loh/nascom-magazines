<?php columnStart(1); ?>
<p>
DRIVE ROUTINES FOR THE GEMINI GM822 RTC MODULE
</p>
<p>
0248&rdquo; 38 08 JR
O2AA&rsquo; BE cp
O2AB&rsquo; 30 05 dR
O2ZAD&rsquo; D6 30 SUB
O2AF&rsquo; 12 LD
o2B0&rsquo; 18 02 JR
3; Error trap
ERR: SCF
RET
3 All valid, so set clock
VALID3: CALL SET
</p>
<p>
VALID3
</p>
<p>
O2B2&rsquo; = 37
O2B3&rsquo; C9
</p>
<p>
02B4&rsquo; cD O1ED&rsquo;
</p>
<p>
O2B7&rsquo;
</p>
<p>
0288&rdquo;
289&rdquo;
O2BA&rsquo;
oO2BB&rsquo;
</p>
<p>
o2c7&rsquo;
02cc9&rsquo;
o2n9&rsquo;
</p>
<p>
cg
</p>
<p>
00
00
02
</p>
<p>
RHEE
</p>
<p>
on ee
</p>
<p>
WRESPC:
</p>
<p>
WSPACE:
STK:
</p>
<p>
STACK:
</p>
<p>
RET
</p>
<p>
DEFB
DEFB
DEFB
DEFS
</p>
<p>
DEFS
DEFS
</p>
<p>
END
</p>
<p>
M-80
</p>
<p>
Work spaces
</p>
<p>
REC
</p>
<p>
DRIVE ROUTINES FOR THE GEMINI GM822 RTC MODULE
</p>
<p>
Macros:
</p>
<p>
Symbols:
OOFF
001
0001
oosp&rsquo;
ooBT&rdquo;
o1B2&rsquo;
0088
008B
oooF
OOOA
00a3&rsquo;
0102&rdquo;
OO1E
o1c3&rsquo;
0080
o24c&rsquo;
o2p9&rdquo;
006c&rsquo;
O1B3&rsquo;
0000&rdquo;
0288&rsquo;
0288&rdquo;
0040
</p>
<p>
No Fatal error(s)
</p>
<p>
ALLIN
BASE
CONIN
CRLF
DYSTRE
HMS
IDYWK
IMONTH
INSTAT
LF
MONTH
OUDATA
PCDATA
PRINT
RDSTRB
RIC
STACK
STMES
TIME10
TTLMES
VALID2
WRKSPC
WRSTRB
</p>
<p>
0000
0005
</p>
<p>
ooao&rsquo;
cogs&rsquo;
0090&rdquo;
o082
oOoFg&rsquo;
0010
OOOA
OOEO
Oo1D
001c
0128&rdquo;
0118&rdquo;
0259&rdquo;
O00
0000
O1E9&rsquo;
0261&rdquo;
o2B4&rsquo;
o1st&rsquo;
O2BRB&rsquo;
</p>
<p>
ALLOUT
BDOS
conourT
DAY
ERMES
HOURS
THOURS
INADDR
INTOUT
LININ
NOSTRBE
PADDR
PDATA
RDRTC
READ
RIC2
START
TEST
TIMES
VALID
VALID3
WRRTC
WSPACE
</p>
<p>
M-80
</p>
<p>
0082
OOFF
eooD
Q09c&rsquo;
O2B2"&rsquo;
0088
0085
ooFro&rsquo;
OOAE&rsquo;
oocc&rsquo;
o10B&rsquo;
oo1r
ort
O13F&rdquo;
O23FT
OED&rsquo;
o2c7&rsquo;
o16c&rsquo;
o00c
0282&rdquo;
ot2i&rsquo;
o162&rsquo;
</p>
<p>
&lsquo;
</p>
<p>
:
,
</p>
<p>
an On te om
</p>
<p>
an en
</p>
<p>
14 Sep 1982 14:48 PAGE 1-8
</p>
<p>
Set the &lt;C&gt; flag to say error
</p>
<p>
All done
</p>
<p>
RREEREEER EEE EER ERE EER EEE EEEE EERE EER EEE ERE EEE EE EEE
</p>
<p>
KEK
</p>
<p>
Interrupt / status
Stop / start
</p>
<p>
Leap year status
Copy of RTC registers
</p>
<p>
Stack save space
Stack space
</p>
<p>
14 Sep 1982 14:48 PAGE S
</p>
<p>
ARGS
CMODE
</p>
<p>
TDAY
IMINS
INDATA
</p>
<p>
MNSTRG
OUADDR
PCADDR
PLSTRG
RDRTCL
RTC
SET
STK
TIME
{MONTH
VALID
WRITE
WRRTCL
</p>
<p>
READ ROUTINE FOR THE GM822 RTC M-80
</p>
<p>
Oo1c
</p>
<p>
oo1c
oo1D
OO1E
Oo1F
</p>
<p>
OOFF
OOFF
0010
</p>
<p>
Qo0c
OORO
0080
</p>
<p>
0000&rdquo;
0002&rdquo;
0004&rdquo;
0006&rdquo;
0008&rdquo;
</p>
<p>
0009&rdquo;
oooB&rdquo;
oooD&rsquo;
ooor&rsquo;
oo11
</p>
<p>
0012&rdquo;
0014&rdquo;
0016&rsquo;
0018&rsquo;
oot A&rdquo;
ootc&rsquo;
O01&rsquo;
</p>
<p>
3E
D3
38
D3
cg
</p>
<p>
38
D3
38
D3
cg
</p>
<p>
38
D3
3B
DS
38
D3
cg
</p>
<p>
FF
15
FF
1E
</p>
<p>
FF
iF
FF
iF
</p>
<p>
FF
iD
FF
iF
10
iF
</p>
<p>
11 Oct 1982
</p>
<p>
10:49 PAGE
</p>
<p>
TITLE READ ROUTINE FOR THE GM822 RTC
</p>
<p>
+Z80
</p>
<p>
GLOBAL TIME
</p>
<p>
BASE
</p>
<p>
EQU
</p>
<p>
1CH
</p>
<p>
3; Port assignments
</p>
<p>
PDATA
PADDR
</p>
<p>
EQU
EQU
</p>
<p>
BASE
BASE+1
</p>
<p>
PCDATA EQU
PCADDR EQU
</p>
<p>
BASE+2
BASE+3
</p>
<p>
te om em om
</p>
<p>
3; Control instructions
</p>
<p>
CMODE QU
ALLIN EQU
INTOUT QU
</p>
<p>
OFFH
OFFH
10H
</p>
<p>
an en on
</p>
<p>
; Addresses for MM58174
</p>
<p>
TMONTH EQU
NOSTRE EQU
RDSTRB EQU
</p>
<p>
12
0E0H
80H
</p>
<p>
en ee
</p>
<p>
PIO control
</p>
<p>
+n an ce
</p>
<p>
3; Set data port to control
</p>
<p>
Base addreas of control PIO
</p>
<p>
Data port for commands
Data port for commands
Control port for data
Control port for data
</p>
<p>
Control mode
All inputs
All out except INT input
</p>
<p>
No strobe or select
Read strobe on
</p>
<p>
subroutines
</p>
<p>
mode, all lines input
</p>
<p>
,
INDATA:
</p>
<p>
LD
our
LD
our
RET
</p>
<p>
A, CMODE
(PODATA),A
A,ALLIN
(PCDATA) ,A
</p>
<p>
Control mode
</p>
<p>
t
3
+
Y
</p>
<p>
7
</p>
<p>
Set mode word
</p>
<p>
Set direction
</p>
<p>
3; Set command port to control mode, all lines input
</p>
<p>
INADDR:
</p>
<p>
.
$
.
3
</p>
<p>
QUADDR:
</p>
<p>
LD
our
LD
OUT
RET
</p>
<p>
A, CMODE
(PCADDR),A
A, ALLIN
(PCADDR),A
</p>
<p>
:
+
&lsquo;
+
</p>
<p>
&lsquo;
</p>
<p>
EXCEPT the INT line (OB4H)
</p>
<p>
Lp
ouT
LD
our
LD
our
RET
</p>
<p>
A, OFFH
(PADDR),A
A, CMODE
(PCADDR),A
A, INTOUT
(PCADDR),A
</p>
<p>
Control mode
Set mode
</p>
<p>
Set direction
</p>
<p>
Set command port to control mode, all lines output
</p>
<p>
Ensure all data lines
&laquo;e+ will be i&rsquo;s
Set mode
</p>
<p>
Set direction
</p>
<p>
*
</p>
<?php columnEnd(1); ?>
