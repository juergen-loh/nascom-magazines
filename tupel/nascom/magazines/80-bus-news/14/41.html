<?php columnStart(1); ?>
<p>
READ ROUTINE FOR THE GM822 RTC M-80
</p>
<p>
OOF&rsquo;
0021&rdquo;
0023&rsquo;
0025&rsquo;
0027&rdquo;
</p>
<p>
0028&rdquo;
o02B&rsquo;
0028&rsquo;
0031!
0033&rdquo;
0035&rsquo;
0037&rdquo;
0039&rsquo;
o03c!
0038&rdquo;
0040&rsquo;
0042&rsquo;
0043&rdquo;
0044&rsquo;
0045&rsquo;
0046&rdquo;
0048&rsquo;
</p>
<p>
0049&rdquo;
004A&rdquo;
0048&rdquo;
0048&rdquo;
oo4F&rsquo;
0050&rsquo;
0051&rdquo;
0052&rdquo;
0053&rdquo;
</p>
<p>
ED
ED
DB
ED
cg
</p>
<p>
cD
cD
2A
06
16
1B
OE
cD
B6
FE
28
TT
23
15
1D
10
cg
</p>
<p>
TE
23
cD
46
23
80
12
13
cg
</p>
<p>
51
59
1c
51
</p>
<p>
0012&rdquo;
</p>
<p>
OO7E&rsquo;
oc
EC
8c
1D
oo1F&rsquo;
</p>
<p>
OF
EG
</p>
<p>
Fi
</p>
<p>
0054&rdquo;
</p>
<p>
RRRH
Sad
RRRE
</p>
<p>
aR ae OR a em em om
</p>
<p>
READ: OUT
out
IN
OUT
RET
</p>
<p>
ee
HERE
</p>
<p>
on em em
</p>
<p>
RDRTC: CALL
CALL
LD
LD
LD
LD
LD
RDRTCL: CALL
AND
cP
JR
LD
Ne
DEC
DEC
DINZ
RET
</p>
<p>
on en
</p>
<p>
BCD2BN: LD
INC
CALL
LD
INC
ADD
LD
INC
RET
</p>
<p>
HeRE Convert n
</p>
<p>
11 Oct 1982
</p>
<p>
10:49 PAGE 1-1
</p>
<p>
BER EEE EEE EE EEF E EEE EEE EEE EEN EERE EOE EE
</p>
<p>
*#**k* Subroutine to read to the MM58174
eee Called with:&ndash;
</p>
<p>
Bar
ERE
</p>
<p>
C=PADDR &ndash; data port for command ***
</p>
<p>
DRTC regliater address
</p>
<p>
E=RTC reg. + strobe (R or W)
JAMMIE HEE EEE BEBE HEHEHE HEHEHE EITHER
</p>
<p>
Read a MM58174 register
</p>
<p>
OUADDR
</p>
<p>
INDATA
</p>
<p>
HL, (PTR)
</p>
<p>
B12
</p>
<p>
D, TMONTH+NOSTRB
B, TMONTH+RDSTRB
C, PADDR
</p>
<p>
READ
</p>
<p>
A, (HL)
HL
TIME10
</p>
<p>
Routine to read the RTC registers
</p>
<p>
to work space in RAM at (HL)
SREB EEEEREEREEEE EEE EEE EERE EEEE EER ERE EER ERES
</p>
<p>
an ae ee a Cg
</p>
<p>
en am
</p>
<p>
-
</p>
<p>
y
</p>
<p>
:
&lsquo;
</p>
<p>
HERE
ee
</p>
<p>
Set up address
Read strobe on
Read a nibble
</p>
<p>
Strobe off
</p>
<p>
REF
PERE
</p>
<p>
Set command port to o/p
Set data port to i/p
</p>
<p>
12 registers to read
</p>
<p>
10&rsquo;s of months + no strobe
10&rsquo;s of months + read strobe
C = control port address
</p>
<p>
Get the data
</p>
<p>
Isolate the lower nibble
Valid?
</p>
<p>
No, so start again
</p>
<p>
Store in workspace
</p>
<p>
Next RIC register
</p>
<p>
Loop if more
Done
</p>
<p>
ibbles into single byte whee
</p>
<p>
Get 10&rsquo;s
</p>
<p>
Get units
</p>
<p>
Save binary
</p>
<p>
READ ROUTINE FOR THE GM822 RTC M-80
</p>
<p>
0054&rdquo;
0055&rsquo;
0056&rdquo;
0057&rsquo;
0058&rsquo;
0059&rsquo;
</p>
<p>
905A&rdquo;
0058&rdquo;
cose&rsquo;
o05D&rdquo;
0055&rdquo;
0061&rdquo;
0064&rdquo;
0067&rsquo;
O06A&rsquo;
06D&rdquo;
O06E&rsquo;
oo6F&rsquo;
0072
0074&rdquo;
0076&rdquo;
ooTT&rsquo;
oo7A&rsquo;
0078&rdquo;
oo7D&rdquo;
</p>
<p>
OTE&rdquo;
</p>
<p>
READ ROUTINE FOR THE GM622 RTC M-80
</p>
<p>
Macros:
</p>
<p>
Symbols:
OOFF
OOFF
0010
Oo1D
oo1e
0039&rdquo;
OO5AT*
oo0oc
</p>
<p>
No Fatal error(s)
</p>
<p>
OT
AT
OT
OT
80
cg
</p>
<p>
OO7E*
0009
oo28&rsquo;
OOTE&rdquo;
0049&rdquo;
04.
</p>
<p>
0049&rdquo;
FQ
</p>
<p>
ALLIN
CMODE
INTOUT
PADDR
PDATA
RDRTICL
TIME
TMONTH
</p>
<p>
11 Oct 1982 10:49
</p>
<p>
Multiply &lt;A&gt; by 10
</p>
<p>
FRE
</p>
<p>
PAGE 1-2
</p>
<p>
on an ow
</p>
<p>
TIME1O: RLCA
</p>
<p>
ee en en an
</p>
<p>
TIME: LD
</p>
<p>
TIME:
</p>
<p>
LD B,A
RLCA
</p>
<p>
RLCA
</p>
<p>
ADD A,B
RET
</p>
<p>
ee rR eR am on
</p>
<p>
Multiply by 2
</p>
<p>
Save the partial product
Multiply by 2 again
Multiply by 2 again
</p>
<p>
Add the partial product
</p>
<p>
RELEREL ERE IRR PO Ok aE EE EEE EE
</p>
<p>
##*#* Get the current date and time in the
</p>
<p>
eee form:- Mth Dy Hr Mn So
</p>
<p>
RHEE
KEKE
</p>
<p>
EERE EERE EEREEEEE EE EEN EER EE EER EEE EE
</p>
<p>
E, (HL)
INC HL
</p>
<p>
LD D, (HL)
EX DE, HL
LD (PTR) ,HL
CALL NDATA
CALL INADDR
CALL RDRTC
</p>
<p>
LD HL, (PTR)
LD D,H
</p>
<p>
LD E,L
CALL BCD2BN
LDI
</p>
<p>
LD BY4
PUSH BC
</p>
<p>
CALL
POP BC
DINZ
RET
</p>
<p>
DEFS 2
</p>
<p>
END
</p>
<p>
11 Oct 1982
</p>
<p>
001c
9009!
</p>
<p>
BASE
TNADDR
OOKO &mdash;- NOSTRB
OO1F PCADDR
COTE&rsquo; PTR
0080 &mdash;-RDSTRB
0076&rsquo; TIME
COO &laquo;= TSTART
</p>
<p>
0049&rsquo;
0000&rdquo;
0012&rdquo;
OO1E
</p>
<p>
0028&rdquo;
OO1F&rsquo;
0054&rdquo;
</p>
<p>
*
</p>
<p>
Y
</p>
<p>
on em ae enn anew
</p>
<p>
oo
</p>
<p>
on
</p>
<p>
Get the addresa of TMS
</p>
<p>
Save it in PIR
Set PIOs to RESET state
</p>
<p>
Get data into workspace
Get back PTR
Put HL in DE
</p>
<p>
41.
</p>
<p>
Do months
Do DYWEEK
</p>
<p>
Do days, hours, mins, secs
</p>
<p>
All done
</p>
<p>
10:49 PAGE s
</p>
<p>
BCD2BN
INDATA
OUADDR
PCDATA
RDRTC
READ
TIME10O
</p>
<?php columnEnd(1); ?>
