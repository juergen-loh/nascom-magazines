<?php columnStart(1); ?>
<p>
ZEAP Z80 Assembler - Source Listing \
</p>
<p>
BOO
BOOO
</p>
<p>
BOOO
BOOO
</p>
<p>
BOOO
BOO]
BOO2
BOO3
BOOS
BOO6
</p>
<p>
BOO8
BOOA
</p>
<p>
BOOC
BOOD
BOOE
BO10
8012
BO1S
8016
BO18
BO1A
BOIC
BOLE
BO20
</p>
<p>
0004
Q005
0006
0007
</p>
<p>
E5
DS
C5
F5
3EOF
D307
</p>
<p>
3E4F
D306
</p>
<p>
Fi
</p>
<p>
F5
</p>
<p>
FEO9
2835
FEOD
282D
FESF
2831
FE21
382D
FE7B
3029
</p>
<p>
0010
0020
0030
0040
0050
0060
0070
</p>
<p>
0090
0100
0110
</p>
<p>
0130
0140
</p>
<p>
0160
</p>
<p>
0180
0190
0200
0210
</p>
<p>
0230
0240
0250
0260
0270
0280
0290
</p>
<p>
0310
0320
0330
0340
</p>
<p>
0360
0370
0380
</p>
<p>
0400
0410
0420
</p>
<p>
0440
0450
0460
0470
0480
0490
0500
0510
0520
0530
0540
0550
</p>
<p>
chek RR RRA RRR KR KKK
3* Golf-ball Print Handler,*
3* Load $UOQUT with start, *
7* 0078/79 for NAS&ldquo;SYS, or,*
3* OFOS/06 for ZEAP, *
</p>
<p>
3* Ray, Cutler,
the ke RRR RRR RR RK
</p>
<p>
25/3/82,*
</p>
<p>
s;Note that no NAS-SYS re&ldquo;start&rsquo;s are used
sso that the routine will run with other
ssoftware,
</p>
<p>
sThe routine is relocatable except for
</p>
<p>
line 5
</p>
<p>
PORTW
PORTS
PORTY
PORTZ
</p>
<p>
START
</p>
<p>
90
ORG
</p>
<p>
EQu
&pound;OU
EQU
EQU
</p>
<p>
PUSH
PUSH
PUSH
PUSH
LD
out
</p>
<p>
Tum
</p>
<p>
HLySave registers,
</p>
<p>
DE
</p>
<p>
BC
</p>
<p>
AF
</p>
<p>
A, &pound;0F
</p>
<p>
(PORTZ) ,A;PIO/B MODE 0,
</p>
<p>
;Control Port for IBM magnets,
</p>
<p>
;PORTX = data port for magnet&rsquo;s,
sCK T2 Tl RS R2A R2 RI when 871,
</p>
<p>
;UC LC SP TAB CRLF
</p>
<p>
36 S
</p>
<p>
4
</p>
<p>
LD
OUT
</p>
<p>
when B7=0,
</p>
<p>
3. 2 #1 = O respectively,
</p>
<p>
A, &pound;4F
(PORTY), A;PIO/A MODE 1
</p>
<p>
;Control port for SHIFT and BUSY status,
</p>
<p>
;PORTW = Data port,
;Rit O = SHIFT (l=LC, O=uC),
sBit 1 = BUSY (l*Ready, O=wait),
</p>
<p>
POP
PUSH
cp
JR
cP
JR
cP
JR
cP
JR
cP
JR
</p>
<p>
AF;A=Valid ASCII code,
</p>
<p>
AF
</p>
<p>
9;Tabulate? (Cntrl I)
</p>
<p>
Z, TABULE
</p>
<p>
&pound;ODsCRLF?
</p>
<p>
Z, CRLF
</p>
<p>
&pound;5PsLeft arrow?
</p>
<p>
2, SPACE
</p>
<p>
&rdquo; +1
</p>
<p>
C, SPACE;It&rsquo;s less than 21H,
Weel]
</p>
<p>
NC, SPACE;It&rsquo;s greater than 7AH,
</p>
<p>
BO22
BO25
3027
B029
BO2A
BO2B
</p>
<p>
BO2C
BO2D
BO2F
BO31
</p>
<p>
B033
BO35
3037
B039
</p>
<p>
BO3B
BO3D
BO3F
5041
</p>
<p>
BO43
BO45
</p>
<p>
BO47
BO49
</p>
<p>
BO4B
</p>
<p>
BO4D
BOSF
</p>
<p>
BO51
BO53
BOSS
</p>
<p>
BO57
BO59
BOSB
BO5D
</p>
<p>
BOSF
BO61
BO63
</p>
<p>
BOGS
BO66
</p>
<p>
B068
BO69
</p>
<p>
218980
D621
600
4F
</p>
<p>
09
</p>
<p>
7E
</p>
<p>
57
</p>
<p>
CBF
DBOS
2008
</p>
<p>
CB47
2031
3E20
1816
</p>
<p>
CB47
2829
3E40
180E
</p>
<p>
3E04
1806
</p>
<p>
3E08
1802
</p>
<p>
3E10
</p>
<p>
D305
181C
</p>
<p>
D305
FE20
2808
</p>
<p>
DBO4
CB47
20FA
1806
</p>
<p>
DBO4
CB47
28FA
</p>
<p>
D305
</p>
<p>
F680
</p>
<p>
0570
0580
0590
0600
0610
0620
0630
0640
</p>
<p>
0660
0670
0680
0690
0700
0710
</p>
<p>
0730
0740
0750
0760
</p>
<p>
0780
0790
0800
0810
</p>
<p>
0830
0840
</p>
<p>
0860
0870
</p>
<p>
0890
</p>
<p>
0910
0920
</p>
<p>
0940
0950
0960
</p>
<p>
0980
0990
1000
1010
1020
1030
</p>
<p>
1050
1060
1070
1080
1090
</p>
<p>
1110
1120
</p>
<p>
1140
1150
</p>
<p>
3A&rdquo;E21 to &pound;7A except &pound;5F
si.e, All printable codes,
</p>
<p>
Lb
SUB
LD
Lo
ADD
LD
</p>
<p>
HL, TABL
&pound;21;A=0 to &pound;59
B, 0
</p>
<p>
C, A
</p>
<p>
HL, BC
</p>
<p>
A, (HL)
</p>
<p>
zAxValid IBM code.
;Bit 7 = Upper-case,
</p>
<p>
SHIFT
</p>
<p>
LOWER
</p>
<p>
UPPER
</p>
<p>
CRLF
</p>
<p>
TABULE
</p>
<p>
SPACE
</p>
<p>
OUTIL
</p>
<p>
OUT2
</p>
<p>
LD
BIT
IN
JR
</p>
<p>
BIT
JR
LD
JR
</p>
<p>
BIT
JR
LD
JR
</p>
<p>
Lb
JR
</p>
<p>
LD
JR
</p>
<p>
LD
</p>
<p>
OUT
JR
</p>
<p>
D, AsSave it,
7,4
</p>
<p>
A, (PORTW)
</p>
<p>
NZ, UPPER
</p>
<p>
0,A;1*LC O=UC
</p>
<p>
NZ,OUT6 ;It&rsquo;s another lower case,
A, &pound;20;Do lower case,
</p>
<p>
OUT2
</p>
<p>
O,As1*LC O=UC
</p>
<p>
Z,OUT6 3It&rsquo;s another upper case,
A, &pound;40;Do upper case,
</p>
<p>
OuT2
</p>
<p>
A, 4;CRLF relay,
OUTIL
</p>
<p>
A, 8
OuTI
</p>
<p>
A, lOH}Space relay,
</p>
<p>
(5), AsSend non=print code,
WAIT
</p>
<p>
(5), AsSend shift code,
20H
Z, OUTS
</p>
<p>
;An upper case code has been sent so
swait for a &lsquo;O&rsquo; from port 4 bit 0,
</p>
<p>
ouT3
</p>
<p>
IN
BIT
JR
JR
</p>
<p>
A, (PORTH)
0,A
NZ,OUT3
OUTS
</p>
<p>
3A lower case code has been sent so
gwait for a &lsquo;1&rsquo; from port 4 bit 0,
</p>
<p>
OUTS
</p>
<p>
OUTS
</p>
<p>
OUTE
</p>
<p>
IN
BIT
JR
</p>
<p>
XOR
OUT
</p>
<p>
LD
OR
</p>
<p>
A, (PORTH)
0,4
Z,OUT4
</p>
<p>
A ;Power down the SHIFT magnets,
(PORTX),A
</p>
<p>
A, Dj;Recover character to print,
800H;Select print magnet drivers,
</p>
<?php columnEnd(1); ?>
